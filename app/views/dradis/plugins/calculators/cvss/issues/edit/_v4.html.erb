<div class="inner note-text-inner d-none" data-cvss-version="4">

  <%= simple_form_for [:cvss, current_project, @issue] do |f| %>

    <div class="alert alert-error" data-behavior="cvss-error">
      <p><strong>Warning</strong>: all Base metrics are required</p>
    </div>

    <ul class="nav nav-pills w-100" id="cvss-tabs">
      <li class="nav-item">
        <a href="#cvss4-edit-base" data-bs-toggle="pill" class="nav-link active">Base</a>
      </li>
      <li class="nav-item">
        <a href="#cvss4-edit-supplemental" data-bs-toggle="pill" class="nav-link">Supplemental</a>
      </li>
      <li class="nav-item">
        <a href="#cvss4-edit-environmental" data-bs-toggle="pill" class="nav-link">Environmental</a>
      </li>
      <li class="nav-item">
        <a href="#cvss4-edit-threat" data-bs-toggle="pill" class="nav-link">Threat</a>
      </li>
      <li class="nav-item pull-right">
        <a href="#cvss4-edit-result" data-bs-toggle="pill" class="nav-link">Result: <span data-behavior="cvss4-result">0.0 (None)</span></a>
      </li>
    </ul>

    <div class="tab-content mt-4">
      <div class="tab-pane active" id="cvss4-edit-base">
        <%= render 'dradis/plugins/calculators/cvss/base/v4/base' %>
      </div>
      <div class="tab-pane" id="cvss4-edit-supplemental">
        <%= render 'dradis/plugins/calculators/cvss/base/v4/supplemental' %>
      </div>
      <div class="tab-pane" id="cvss4-edit-environmental">
        <%= render 'dradis/plugins/calculators/cvss/base/v4/environmental' %>
      </div>
      <div class="tab-pane" id="cvss4-edit-threat">
        <%= render 'dradis/plugins/calculators/cvss/base/v4/threat' %>
      </div>

      <div class="tab-pane" id="cvss4-edit-result">
        <textarea class="form-control" name="cvss_fields" rows="10" style="width:95%">#[CVSSv4.Vector]#
N/A

#[CVSSv4.BaseScore]#
N/A

#[CVSSv4.BaseSeverity]#
N/A

#[CVSSv4.MacroVector]#
#[CVSSv4.Expoitability]#
#[CVSSv4.Complexity]#
#[CVSSv4.VulnerableSystem]#
#[CVSSv4.SubsequentSystem]#
#[CVSSv4.Exploitation]#
#[CVSSv4.SecurityRequirements]#

#[CVSSv4.BaseExploitableAttackVector]#
#[CVSSv4.BaseExploitableAttackComplexity]#
#[CVSSv4.BaseExploitableAttackRequirements]#
#[CVSSv4.BaseExploitablePrivilegesRequired]#
#[CVSSv4.BaseExploitableUserInteraction]#
#[CVSSv4.BaseVulnerableConfidentiality]#
#[CVSSv4.BaseVulnerableIntegrity]#
#[CVSSv4.BaseVulnerableAvailability]#
#[CVSSv4.BaseSubsequentConfidentiality]#
#[CVSSv4.BaseSubsequentIntegrity]#
#[CVSSv4.BaseSubsequentAvailability]#

#[CVSSv4.SupplementalSafety]#
#[CVSSv4.SupplementalAutomatable]#
#[CVSSv4.SupplementalRecovery]#
#[CVSSv4.SupplementalValueDensity]#
#[CVSSv4.SupplementalVulnerabilityResponseEffort]#
#[CVSSv4.SupplementalProviderUrgency]#

#[CVSSv4.EnvironmentalExploitabilityAttackVector]#
#[CVSSv4.EnvironmentalExploitabilityAttackComplexity]#
#[CVSSv4.EnvironmentalExploitabilityAttackRequirements]#
#[CVSSv4.EnvironmentalExploitabilityPrivilegesRequired]#
#[CVSSv4.EnvironmentalExploitabilityUserInteraction]#
#[CVSSv4.EnvironmentalVulnerableConfidentiality]#
#[CVSSv4.EnvironmentalVulnerableIntegrity]#
#[CVSSv4.EnvironmentalVulnerableAvailability]#
#[CVSSv4.EnvironmentalSubsequentConfidentiality]#
#[CVSSv4.EnvironmentalSubsequentIntegrity]#
#[CVSSv4.EnvironmentalSubsequentAvailability]#
#[CVSSv4.EnvironmentalConfidentialityRequirements]#
#[CVSSv4.EnvironmentalIntegrityRequirements]#
#[CVSSv4.EnvironmentalAvailabilityRequirements]#

#[CVSSv4.ThreatExploitMaturity]#
        </textarea>
      </div>
    </div>

    <div class="form-actions">
      <%= f.button :submit, nil, class: 'btn btn-primary' %> or
      <%= link_to 'Cancel', main_app.project_issue_path(current_project, @issue), class: 'cancel-link' %>
    </div>
  <% end %>
</div>
